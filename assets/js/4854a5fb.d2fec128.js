(self.webpackChunkplatform_docs=self.webpackChunkplatform_docs||[]).push([[803],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return d}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(n),d=r,h=m["".concat(s,".").concat(d)]||m[d]||p[d]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1360:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c},default:function(){return p}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),o=["components"],l={sidebar_position:3},s={unversionedId:"tutorial/mint-an-item",id:"tutorial/mint-an-item",isDocsHomePage:!1,title:"Mint an existing item",description:"Note: to follow this tutorial, simply copy/paste the curl requests, or use the Postman collection located here",source:"@site/docs/tutorial/mint-an-item.md",sourceDirName:"tutorial",slug:"/tutorial/mint-an-item",permalink:"/platform-docs/docs/tutorial/mint-an-item",editUrl:"https://github.com/jwa-lab/platform-docs/docs/docs/tutorial/mint-an-item.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Create a new item",permalink:"/platform-docs/docs/tutorial/create-an-item"},next:{title:"Assign an item",permalink:"/platform-docs/docs/tutorial/assign-an-item"}},c=[{value:"Get Warehouse smart contract address",id:"get-warehouse-smart-contract-address",children:[]},{value:"Get a warehouse item by id",id:"get-a-warehouse-item-by-id",children:[]}],u={toc:c};function p(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Note: to follow this tutorial, simply copy/paste the ",(0,i.kt)("inlineCode",{parentName:"em"},"curl")," requests, or use the ",(0,i.kt)("a",{parentName:"em",href:"https://github.com/jwa-lab/tokenization-service/blob/main/postman_collection/JWA%20Platform%20-%20Tokenization%20Service.postman_collection.json"},"Postman collection located here"))),(0,i.kt)("p",null,"We have now created an item in the item store and we want to move it to the blockchain. Our item has an ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," which is a number greater than ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),". It was asigned when the item was first created.\nMoving the item to the blockchain will effectively create our first NFT!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"% curl --location --request PUT 'http://localhost:8000/api/tokenization-service/warehouse/<item id>'\n")),(0,i.kt)("p",null,"Which will return the object as it was retrieved from the item store:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "available_quantity": 1,\n    "data": {\n        "level": "legendary",\n        "type": "goose",\n        "attribute": "gold"\n    },\n    "item_id": <item id>,\n    "name": "Golden Goose",\n    "total_quantity": 1\n}\n')),(0,i.kt)("p",null,"This requests takes some time to execute, because writing an item in the blockchain is slow and the request is synchronous, it will only complete when the operation completes in the Tezos blockchain.\nAlso note the ",(0,i.kt)("inlineCode",{parentName:"p"},"PUT")," request and the ",(0,i.kt)("inlineCode",{parentName:"p"},"item_id")," in the URL. There is no need to describe the item, its current state will be read directly from the item store."),(0,i.kt)("p",null,"We have now tokenized, or minted, our first item as an NFT. Let take a look in the blockchain!"),(0,i.kt)("h2",{id:"get-warehouse-smart-contract-address"},"Get Warehouse smart contract address"),(0,i.kt)("p",null,"First, let's obtain the smart contract address that holds all items:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl --location --request GET 'http://localhost:8000/api/tokenization-service/info'\n")),(0,i.kt)("p",null,"which returns:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "warehouse_address": "<warehouse contract KT1 address>"\n}\n')),(0,i.kt)("p",null,"Using this address, we can find its details in the blockchain:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://localhost:8002/explorer/contract/<warehouse contract KT1 address>\n")),(0,i.kt)("p",null,"Which returns"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "address": "<warehouse contract KT1 address>",\n  "manager": "tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb",\n  "delegate": "",\n  "height": 3,\n  "fee": 0.007314,\n  "gas_limit": 53481,\n  "gas_used": 53381,\n  "gas_price": 0.13702,\n  "storage_limit": 1974,\n  "storage_size": 1717,\n  "storage_paid": 1717,\n  "is_funded": false,\n  "is_vesting": false,\n  "is_spendable": false,\n  "is_delegatable": false,\n  "is_delegated": false,\n  "first_in": 0,\n  "first_out": 0,\n  "last_in": 0,\n  "last_out": 0,\n  "first_seen": 3,\n  "last_seen": 19,\n  "delegated_since": 0,\n  "first_in_time": "0001-01-01T00:00:00Z",\n  "first_out_time": "0001-01-01T00:00:00Z",\n  "last_in_time": "0001-01-01T00:00:00Z",\n  "last_out_time": "0001-01-01T00:00:00Z",\n  "first_seen_time": "2021-05-17T04:06:03Z",\n  "last_seen_time": "2021-05-17T04:09:28Z",\n  "delegated_since_time": "0001-01-01T00:00:00Z",\n  "n_ops": 5,\n  "n_ops_failed": 0,\n  "n_tx": 5,\n  "n_delegation": 0,\n  "n_origination": 0,\n  "token_gen_min": 0,\n  "token_gen_max": 0,\n  "bigmap_ids": [\n    <bigmap id>\n  ],\n  "op_l": 3,\n  "op_p": 0,\n  "op_i": 0,\n  "iface_hash": "131b099e",\n  "call_stats": [\n    1,\n    2,\n    0,\n    0\n  ]\n}\n')),(0,i.kt)("p",null,"Notice that the smart contract is assigned a storage in the form of a bigmap. You can find its bigmap id in the response."),(0,i.kt)("p",null,"Using the bigmap id, let's see all available items:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-curl"},"curl http://localhost:8002/explorer/bigmap/<bigmap id>\n")),(0,i.kt)("p",null,"Which returns:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "contract": "KT1SPr1ZaoEwpB354PybTocYbfcbfqhjtfj9",\n  "bigmap_id": <bigmap id>,\n  "n_updates": 3,\n  "n_keys": 1,\n  "alloc_height": 3,\n  "alloc_block": "BMWxxCLW9zSWpbhoXdEXeJh52zJL9veKGVLKhLDFNzNKo3H9HkN",\n  "alloc_time": "2021-05-17T04:06:03Z",\n  "update_height": 19,\n  "update_block": "BM9tifLhBceZQQ3iVR2q6sbLVZ422jXm3ZEcneZfFEViE5LALaF",\n  "update_time": "2021-05-17T04:09:28Z",\n  "type": {\n    "key_type": "nat",\n    "value_type": {\n      "available_quantity": "nat",\n      "data@map": {\n        "0": "string",\n        "1": "string"\n      },\n      "item_id": "nat",\n      "name": "string",\n      "no_update_after@option": {\n        "0": "timestamp"\n      },\n      "total_quantity": "nat"\n    }\n  }\n}\n')),(0,i.kt)("p",null,"You can see that it currently has ",(0,i.kt)("inlineCode",{parentName:"p"},"n_keys")," ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),", which means it has one key, or one entry. Let's see what that is:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-curl"},"curl http://localhost:8002/explorer/bigmap/1/keys\n")),(0,i.kt)("p",null,"which returns the list of keys:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'[\n  {\n    "key": "1",\n    "key_hash": "expru2dKqDfZG8hu4wNGkiyunvq2hdSKuVYtcKta7BWP6Q18oNxKjS",\n    "key_binary": "1",\n    "meta": {\n      "contract": "KT1SPr1ZaoEwpB354PybTocYbfcbfqhjtfj9",\n      "bigmap_id":<bigmap id>,\n      "time": "2021-05-17T04:09:28Z",\n      "height": 19,\n      "block": "BM9tifLhBceZQQ3iVR2q6sbLVZ422jXm3ZEcneZfFEViE5LALaF",\n      "is_replaced": false,\n      "is_removed": false\n    }\n  }\n]\n')),(0,i.kt)("p",null,"Notice that there's only one key with index 1. Let's dig into it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://localhost:8002/explorer/bigmap/<bigmap id>/<key id>\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "1",\n  "key_hash": "expru2dKqDfZG8hu4wNGkiyunvq2hdSKuVYtcKta7BWP6Q18oNxKjS",\n  "key_binary": "1",\n  "value": {\n    "available_quantity": "1",\n    "data": {\n      "attribute": "gold",\n      "level": "legendary",\n      "type": "goose"\n    },\n    "item_id": "1",\n    "name": "Golden Goose",\n    "no_update_after": null,\n    "total_quantity": "1"\n  },\n  "meta": {\n    "contract": "KT1SPr1ZaoEwpB354PybTocYbfcbfqhjtfj9",\n    "bigmap_id": 1,\n    "time": "2021-05-17T04:09:28Z",\n    "height": 19,\n    "block": "BM9tifLhBceZQQ3iVR2q6sbLVZ422jXm3ZEcneZfFEViE5LALaF",\n    "is_replaced": false,\n    "is_removed": false\n  }\n}\n')),(0,i.kt)("p",null,"Here's our golden goose!"),(0,i.kt)("h2",{id:"get-a-warehouse-item-by-id"},"Get a warehouse item by id"),(0,i.kt)("p",null,"We know the id of our warehouse item, instead of looking directly inside the blockchain, let's retrieve it via a rest call:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl --location --request GET 'http://localhost:8000/api/tokenization-service/warehouse/1'\n")),(0,i.kt)("p",null,"Which returns"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "available_quantity": 1,\n    "name": "Golden Goose",\n    "item_id": 1,\n    "total_quantity": 1,\n    "data": {\n        "attribute": "gold",\n        "level": "legendary",\n        "type": "goose"\n    }\n}\n')),(0,i.kt)("p",null,"Now that we have created items, let's assign them to users."))}p.isMDXComponent=!0}}]);